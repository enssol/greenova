<!--
  Copyright 2025 Enveng Group.
  SPDX-License-Identifier: 	AGPL-3.0-or-later
  Base HTML template for Greenova Environmental Management System

  This template provides the core structure for all pages in the application.

  Features:
  - Responsive design using PicoCSS
  - Dark/Light theme support
  - HTMX for dynamic content loading
  - Hyperscript for client-side interactivity
  - WCAG 2.1 AA compliance
-->
{% load static %}
{% load hyperscript %}
{% load hyperscript %}
{% load django_htmx %}
{% load tailwind_tags %}
{% load user_tags %}
{% load core_tags %}
{% load user_tags %}
{% load core_tags %}
<!DOCTYPE html>
<html lang="en" data-theme="light dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="color-scheme" content="light dark" />
    <meta name="keywords"
          content="environmental compliance, management system, greenova, sustainability" />
    <meta name="description" content="
      {% block meta_description %} Environmental Compliance Management System {% endblock meta_description %}" />
      <title>

        {% block title %}

          {% block page_title %}

    <!-- Header with semantic nav -->
    <header role="banner">
      <!-- MAIN NAVIGATION: Full-width container -->
      <nav role="navigation" aria-label="Main navigation">
        <!-- LEFT ALIGNED: Theme switcher -->
        {% theme_switcher %}

        <!-- BREADCRUMB NAVIGATION: Top of content area -->
        <nav aria-label="Breadcrumb navigation" role="navigation" class="breadcrumb-container">
          <ul>
            <!-- LEFT ALIGNED: Breadcrumbs -->
            <li class="menubar-breadcrumbs">
              {% breadcrumb_navigation %}
            </li>
          </ul>
        </nav>

    <!-- FOOTER: Full-width at bottom of page -->
    {% block footer %}
    <footer role="contentinfo">
      <p>
        Â© {% now "Y" %} <a href="https://www.enveng-group.com.au/"
        target="_blank"
        rel="noopener noreferrer">Enveng Group</a> |
        Licensed under <a href="https://www.gnu.org/licenses/agpl-3.0.html"
        target="_blank"
        rel="noopener noreferrer">GNU AGPL v3.0</a>
      </p>
    </footer>
    {% endblock footer %}

    <!-- SCRIPTS: Loaded at end of document -->
    <script src="{% static 'js/vendor/htmx/htmx.min.js' %}" defer></script>
    {% django_htmx_script %}
    <!-- Extensions -->
    <script src="{% static 'js/vendor/htmx/ext/head-support.min.js' %}" defer></script>
    <script src="{% static 'js/vendor/htmx/ext/loading-states.min.js' %}" defer></script>
    <script src="{% static 'js/vendor/htmx/ext/class-tools.min.js' %}" defer></script>
    <script src="{% static 'js/vendor/htmx/ext/path-deps.min.js' %}" defer></script>
    <script src="{% static 'js/vendor/_hyperscript.min.js' %}" defer></script>
    <script src="{% static 'js/app.js' %}" defer></script>

    <!-- Initialize extensions -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        htmx.config.useTemplateFragments = true;
        // Don't try to define extensions, they're already registered via the hx-ext attribute

        {% if debug %}
          if (typeof window.htmx !== "undefined") {
              htmx.on("htmx:afterSettle", function(detail) {
                  if (
                      typeof window.djdt !== "undefined"
                      && detail.target instanceof HTMLBodyElement
                  ) {
                      djdt.show_toolbar();
                  }
              });
          }
        {% endif %}
      });
    </script>
  </body>
</html>
